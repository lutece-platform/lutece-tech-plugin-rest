<?xml version="1.0" encoding="UTF-8"?>
<document>
    <properties>
        <title>
            Installation du plug-in RSS
        </title>
    </properties>
    <body>
        <section name="Installation du plug-in RSS">
            <subsection name="Caractéristiques">
                <p>
                    <ul>
                        <li>La fonction RSS est mise en oeuvre au travers d’un plugin
                            dédié,
                        </li>
                        <li>Il n’existe pas d’interface de publication dans le menu «
                            administration du site ». Chaque webmestre pourra proposer
                            dans une rubrique de type « Html texte libre » la liste des
                            URL vers ses fichiers RSS.
                        </li>
                        <li>La norme utilisée pour l’implémentation de la fonction de
                            RSS est la version 2.0.
                        </li>
                    </ul>
                </p>
            </subsection>
            <subsection name="Installation des binaires">
                <p>
                    L'installation des binaires suit la procédure habituelle
                    pour les plug- ins : il faut arrêter le serveur Tomcat et
                    décompresser le fichier <code>plugin-rss-bin-XXXXXX.zip</code> dans
                    le répertoire de base de la webapp.
                </p>
            </subsection>
            <subsection name="Modification de la base de données">
                <p>Ce plug-in nécessite la création d'une nouvelle table dans
                    la base de données. Pour cela, lancer le script
                    <code>create_db_rss.sql</code> situé dans le répertoire
                    <code>sql/plugins/rss</code>.
                </p>
            </subsection>
            <subsection name="Configuration">
                <p style="h4">
                    Fichier de configuration de Lutèce :
                    <code>WEB-INF/conf/lutece.properties</code>
                </p>
                <p>
                    <ul>
                        <li>répertoire de la webapp destiné au stockage des données
                            des plug-ins : <code>path.plugins.warehouse=/plugins</code>
                        </li>

                    </ul>
                </p>
                <p style="h4">
                    Paramétrage du démon de mise à jour des fichiers RSS
                </p>
                <p>
                Il faut déclarer le démon <code>generateRssFilesDeamon</code>
                en l'ajoutant à la propriété <code>dameons.list</code> :
                <div class="source">
                    <pre>
                        daemons.list=indexer,autopublishing,generateRssFiles
                    </pre>        
                </div>    
                Puis on paramètre le démon en ajoutant les propriétés
                suivantes :
                <ul>
                    <li>nom de la classe Java :
                        <code>daemon.generateRssFiles.classname=fr.paris.lutece.plugins.pushrss.service.daemon.GenerateRssFilesDaemon</code>.
                    </li>
                    <li>intervalle de lancement (en secondes) :
                        <code>daemon.generateRssFiles.interval=200</code>
                    </li>
                    <li>lancement au démarrage du système (0 = non, 1 = oui)
                        :

                        <code>daemon.generateRssFiles.onstartup=1</code>
                    </li>
                </ul>
                </p>
                <p style="h4">
                    Fichier de configuration du plug-in :
                    <code>WEB-INF/conf/plugins/rss.properties</code>
                </p>
                <p>
                    <ul>
                        <li>Nombre maximum d’articles par rubrique pris en compte
                            dans la génération du fichier RSS :
                            <code>rss.max.articles=15</code>
                        </li>
                        <li>Extension des fichiers créés :
                            <code>rss.file.type=rss</code>
                        </li>
                        <li>Feuille de style pour l’affichage d’un fichier RSS dans
                            une popup d’aperç u du contenu :
                            <code>rss.xsl.stylesheet.id=90</code>
                        </li>
                        <li>Images correspondant aux états de génération d’un fichier
                            RSS :
                            <code>rss.picture.ok=green_button.gif</code>
                            <code>rss.picture.ko=red_button.gif</code>
                        </li>
                        <li>Messages correspondant aux différents états de génération
                            des fichiers RSS :
                            <code>message.rss.state.1=La rubrique a
                            &amp;eacute;t&amp;eacute; supprim&amp;eacute;e</code>

                            <code>message.rss.state.2=Il y a eut un probl&amp;egrave;me
                            dans la g&amp;eacute;n&amp;eacute;ration du fichier</code>
                        </li>
                        <li>Nom du répertoire de stockage des fichiers RSS :
                            <code>rss.storage.directory=rss</code>
                        </li>
                        <li>Taille maximale des noms des fichiers :
                            <code>rss.name.max.length=60</code>
                        </li>
                    </ul>
                </p>
            </subsection>
            <subsection name="Création du répertoire de stockage des fichiers RSS">
                <p>
                    Créer le répertoire défini par les deux propriétés
                    décrites ci-dessus :
                    <div class="source">
                    <pre>
path.plugins.warehouse/rss.storage.directory
                    </pre>
                    </div>
                    Les droits en lecture et écriture doivent être donnés pour ce
                    répertoire.
                    Les noms des fichiers RSS générés par l’application et stockés
                    dans ce répertoire ne doivent jamais être modifiés, car ils
                    sont aussi stockés dans la table <code>rss_generation</code> de la
                    base de données. Par conséquent il faut toujours vérifier la
                    cohérence entre la base et le contenu du répertoire.
                </p>
                <p>
                    Si un fichier RSS correspondant à une rubrique est généré dans
                    le répertoire et si par la suite la rubrique est supprimée, le
                    fichier ne sera pas pour autant supprimé afin de ne pas
                    provoquer une erreur d’affichage pour l’internaute qui aurait
                    créé un lien vers ce fichier.
                </p>
            </subsection>
            <subsection name="Activation du plug-in">
                <p>
                    Cette opération s'effectue aprè le redémarrage de Tomcat
                    et permet de mettre à disposition du webmestre la fonction RSS.
                    Elle est similaire à l’activation de n’importe quel
                    plugin.
                </p>
                <p>
                    Il faut sélectionner le menu « gestion des plugins » en étant
                    connecté comme administrateur. On sélectionne l’action «
                    activer » pour le plugin « rss ».
                    Dans le menu « gestion des utilisateurs » on sélectionne
                    l’utilisateur et on modifie ses droits afin de lui donner accès
                    à la fonction « rss ».
                </p>
            </subsection>
        </section>
    </body>
</document>  
  